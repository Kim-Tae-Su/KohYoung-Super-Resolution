# Super Resolution

## 1. 프로젝트 개요

- 프로젝트명: Super Resolution
- 프로젝트 소속: 고영테크놀러지
- 프로젝트 기간: 2024.09 ~ 2025.01
- 프로젝트 인원: 2명

### Super Resolution 개요
Super Resolution(SR)은 저해상도 이미지를 입력으로 받아  
고해상도 이미지를 복원하는 이미지 복원(Image Restoration) 기술이다.

### 프로젝트 목표
고영테크놀러지 반도체 검사 장비는 정확한 위치로 모션 이동을 위해 Machine Calibration(Mcal) 이미지 파일을 측정하여 활용하고 있다.  
그러나 기존 이미지 파일 측정 및 생성 시간이 오래 걸려 생산 효율성을 저하시키는 문제가 있다.

본 프로젝트에서는 저해상도(LR) Calibration 데이터를 고해상도(HR)로 복원하는 딥러닝 기반 Super-Resolution(SR) 모델을 개발하여  
Calibration 이미지 생성 시간을 단축하고 장비 보정 정확도를 향상시키는 것을 목표로 한다.

---

## 2. 담당 역할
### 데이터 로딩
- 데이터 수집
- 자사CRM 크롤링 스크립트 작성 

### 데이터 로딩
- 시퀀스 기반 데이터 로더 설계
- 이미지 파일을 NumPy 배열 형태로 변환

### 데이터 전처리
- 저해상도(LR) 및 고해상도(HR) 이미지 생성
- 노이즈 제거 및 Scaling 처리

### 모델 설계 및 구현
- Super-Resolution 모델 후보 조사 및 선정
- 관련 논문 분석
- SR 모델 구조 구현

### 모델 학습 및 튜닝
- 학습 / 검증 / 테스트 데이터셋 분할
- 하이퍼파라미터 튜닝
- 최적화 기법 적용

### 모델 검증 및 테스트
- PSNR, SSIM 지표를 활용한 복원 성능 평가
- 복원된 HR 이미지와 실제 장비 오차 이미지 비교 분석
- 실제 장비 적용 가능성 검증

---

## 3. 기술적 문제

- 전체 데이터셋 기준으로 정규화를 수행할 경우 일부 이미지의 픽셀 값이 극단적으로 작거나 크게 왜곡되는 현상 발생
- 학습 과정에서 모델이 특정 이미지에 bias를 가지며 성능 저하 발생

---

## 4. 문제 원인

Calibration 이미지는 일반적인 RGB 이미지와 달리  
이미지마다 픽셀 값의 분포 범위가 상이하였다.

예시:
- [-50, 50]
- [-200, 200]

이러한 특성으로 인해 전체 데이터셋 기준 Min-Max 정규화를 적용할 경우,
특정 이미지의 정보가 과도하게 압축되거나 확장되어
모델 학습 안정성과 성능이 저하되었다.

---

## 5. 문제 해결 방법

### 이미지 개별 기준 Min-Max Scaling 적용
각 이미지 단위로 Min-Max 스케일링을 수행하여  
모든 입력 이미지를 [0, 1] 범위로 정규화하였다.

정규화 수식:
X_norm = (X - X_min) / (X_max - X_min)

- X_min, X_max: 개별 이미지 기준 최소값, 최대값

### 복원 단계에서 원래 값 범위로 역변환
모델이 예측한 고해상도 이미지를
각 이미지의 원래 Min / Max 값을 사용하여 역변환하였다.

복원 수식:
X_restore = X_pred * (X_max - X_min) + X_min

이를 통해 복원 후에도 물리적 해석이 가능한 Calibration 이미지를 유지하였다.

---

## 6. 결과 및 성과

- Mcal 오차 이미지 파일 생성 시간 약 90% 단축
- 고정밀 장비 보정 정확도 향상
- 총 5종의 Super-Resolution 모델 설계 및 시뮬레이션 수행
- 최적 SR 모델 선별
- SR 기술 기반 실시간 보정 시스템 초기 기반 구축
- 기술 제안 → 설계 → 구현 → 적용까지 End-to-End 프로세스 수행

---

## 7. 사용 기술

- Language
  - Python
- Deep Learning
  - Keras
  - TensorFlow
- Data Processing
  - NumPy
  - OpenCV

---

## 8. 프로젝트 의의

본 프로젝트는 Super-Resolution 모델 구현에 그치지 않고,  
실제 장비 환경의 데이터 특성과 물리적 해석 가능성을 고려하여  
현업 적용이 가능한 딥러닝 기반 Calibration 시스템을 구축한 경험이다.
